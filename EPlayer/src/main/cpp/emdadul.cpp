
#include <jni.h>
#include <string>

// Encrypted string
static std::string encryptedString = "; CNBSXOD\u001Fgslk=\t;gslk=\t\u001F\u001F\u001F;gd`c=\t\u001F\u001F\u001F\u001F\u001F\u001F;rsxkd\u001Fsxod<!sdws.brr!=\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fheq`ld\u001Fz\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fonrhshnm9\u001F`arnktsd:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fanqcdq9\u001Fmnmd:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fgdhfgs9\u001F0//$:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fvhcsg9\u001F0//$:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fsno9\u001F/:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fkdes9\u001F/:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fanssnl9\u001F/:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fqhfgs9\u001F/:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F|\t\u001F\u001F\u001F\u001F\u001F\u001F;.rsxkd=\t\u001F\u001F\u001F;.gd`c=\t\u001F\u001F\u001F;ancx=\t\u001F\u001F\u001F\u001F\u001F\u001F;chu\u001Fhc<!ok`xdq!=;.chu=\t\u001F\u001F\u001F\u001F\u001F\u001F;rbqhos=\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fu`q\u001Fs`f\u001F<\u001Fcnbtldms-bqd`sdDkdldms'&rbqhos&(:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fs`f-rqb\u001F<\u001F!gssor9..vvv-xntstad-bnl.heq`ld^`oh!:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fu`q\u001FehqrsRbqhosS`f\u001F<\u001Fcnbtldms-fdsDkdldmsrAxS`fM`ld'&rbqhos&(Z/\\:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001FehqrsRbqhosS`f-o`qdmsMncd-hmrdqsAdenqd's`f+\u001FehqrsRbqhosS`f(:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fetmbshnm\u001FnmXntStadHeq`ld@OHQd`cx'(\u001Fz\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fok`xdq\u001F<\u001Fmdv\u001FXS-Ok`xdq'&ok`xdq&+\u001Fz\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fok`xdqU`qr9\u001Fz\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F&ok`xrhmkhmd&9\u001F0+\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F&qdk&9\u001F/+\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F&rgnvhmen&9\u001F/\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F|+\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fdudmsr9\u001Fz\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F&nmQd`cx&9\u001FnmOk`xdqQd`cx+\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F&nmRs`sdBg`mfd&9\u001FnmOk`xa`bjRs`sdBg`mfd+\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F&nmDqqnq&9\u001FnmOk`xdqDqqnq\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F|\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F|(:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F|\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fetmbshnm\u001FnmOk`xdqQd`cx'(\u001Fz\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001FIOk`xdq-nmOk`xdqQd`cx'(:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F|\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fetmbshnm\u001FnmOk`xa`bjRs`sdBg`mfd'dudms(\u001Fz\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001FIOk`xdq-nmOk`xa`bjRs`sdBg`mfd'dudms-c`s`(:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F|\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fetmbshnm\u001FnmOk`xdqDqqnq'(\u001Fz\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001FIOk`xdq-nmOk`xdqDqqnq'(:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F|\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001Fetmbshnm\u001FnmQdbdhudUhcdnHcr'(\u001Fz\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001FIOk`xdq-nmQdbdhudUhcdnHcr'ok`xdq-fdsOk`xkhrs'((:\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F|\t\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\u001F\t\u001F\u001F\u001F\u001F\u001F\u001F;.rbqhos=\t\u001F\u001F\u001F;.ancx=\t;.gslk=";

// Decrypt function
std::string decryptString(const std::string &encrypted) {
    std::string decrypted;
    for (char c: encrypted) {
        decrypted += static_cast<char>(c + 1);
    }


    size_t pos = 0;
    std::string from = "JPlayer";
    std::string to = "EPlayer";
    while ((pos = decrypted.find(from, pos)) != std::string::npos) {
        decrypted.replace(pos, from.length(), to);
        pos += to.length();
    }


    return decrypted;
}










extern "C" JNIEXPORT jstring JNICALL
Java_com_emdadul_EPlayer_initialize(JNIEnv *env, jobject thiz) {
    // Decrypt the string
    std::string decryptedString = decryptString(encryptedString);

    // Convert the decrypted string to jstring and return
    return env->NewStringUTF(decryptedString.c_str());
}
extern "C" JNIEXPORT jstring JNICALL
Java_com_emdadul_EPlayer_getAllVideoIds(JNIEnv *env, jobject thiz) {
    std::string getAllVideoIds = "javascript:onReceiveVideoIds()";
    return env->NewStringUTF(getAllVideoIds.c_str());
}
extern "C" JNIEXPORT jstring JNICALL
Java_com_emdadul_EPlayer_loadAllVideos(JNIEnv *env, jobject thiz, jstring video_id,
                                        jint position) {
    const char *videoIdStr = env->GetStringUTFChars(video_id, nullptr);

    // Create the desired C++ string
    std::string result = "javascript:player.cuePlaylist({listType:'playlist',list: '";
    result += videoIdStr;
    result += "', index: ";
    result += std::to_string(position);
    result += ", startSeconds: 0})";

    // Release the converted Java string
    env->ReleaseStringUTFChars(video_id, videoIdStr);

    // Convert the C++ string to Java string and return it
    return env->NewStringUTF(result.c_str());
}

extern "C" JNIEXPORT jstring JNICALL
Java_com_emdadul_VideoInfoRepository_getInfo(JNIEnv *env, jobject thiz, jstring id) {
    const char *idStr = env->GetStringUTFChars(id, nullptr);
    std::string result;

    if (strlen(idStr) == 11) {
        result = "https://www.youtube.com/oembed?url=youtube.com/watch?v=";
        result += idStr;
        result += "&format=json";
    } else {
        result = "https://www.youtube.com/oembed?url=https://www.youtube.com/playlist?list=";
        result += idStr;
        result += "&type.json";
    }

    env->ReleaseStringUTFChars(id, idStr);
    return env->NewStringUTF(result.c_str());
}
